<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>pypegase.stellibs package &mdash; pyPegase 1.0 documentation</title>
    
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="pyPegase 1.0 documentation" href="index.html" />
	<script type="text/x-mathjax-config"> MathJax.Hub.Config({
		"TeX": {Macros: {AA : "{\\unicode{x212B}}"}}, "HTML-CSS": {scale: 90}});
	</script>

  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="index.html">pyPegase 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="pypegase-stellibs-package">
<h1>pypegase.stellibs package<a class="headerlink" href="#pypegase-stellibs-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-pypegase.stellibs.basel">
<span id="pypegase-stellibs-basel-module"></span><h2>pypegase.stellibs.basel module<a class="headerlink" href="#module-pypegase.stellibs.basel" title="Permalink to this headline">¶</a></h2>
<p>Stellar library class</p>
<p>Intent to implement a generic module to manage stellar library from various
sources.</p>
<p>The interpolation is implemented from the pegase.2 fortran converted algorithm.
(this may not be super pythonic though)</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">a cython version is available for speed up and should be used transparently when available
(run make once)</p>
</div>
<dl class="class">
<dt id="pypegase.stellibs.basel.BaSeL">
<em class="property">class </em><tt class="descclassname">pypegase.stellibs.basel.</tt><tt class="descname">BaSeL</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/pypegase/stellibs/basel.html#BaSeL"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypegase.stellibs.basel.BaSeL" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pypegase.stellibs.stellib.Stellib" title="pypegase.stellibs.stellib.Stellib"><tt class="xref py py-class docutils literal"><span class="pre">pypegase.stellibs.stellib.Stellib</span></tt></a></p>
<dl class="docutils">
<dt>BaSeL 2.2 library derived class</dt>
<dd>This library + Rauch is used in Pegase.2</dd>
</dl>
<p>The BaSeL stellar spectral energy distribution (SED) libraries are libraries
of theoretical stellar SEDs recalibrated using empirical photometric data.
Therefore, we call them semi-empirical libraries.</p>
<p>The BaSeL 2.2 library was calibrated using photometric data from solar
metallicity stars.</p>
<p class="rubric">References</p>
<ul class="simple">
<li>Lejeune, Cuisiner, and Buser, 1998 A&amp;AS, 130, 65</li>
<li>can be downloaded <a class="reference external" href="http://www.astro.unibas.ch/BaSeL_files/BaSeL2_2.tar.gz">http://www.astro.unibas.ch/BaSeL_files/BaSeL2_2.tar.gz</a></li>
</ul>
<dl class="attribute">
<dt id="pypegase.stellibs.basel.BaSeL.NHI">
<tt class="descname">NHI</tt><a class="reference internal" href="_modules/pypegase/stellibs/basel.html#BaSeL.NHI"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypegase.stellibs.basel.BaSeL.NHI" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pypegase.stellibs.basel.BaSeL.NHeI">
<tt class="descname">NHeI</tt><a class="reference internal" href="_modules/pypegase/stellibs/basel.html#BaSeL.NHeI"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypegase.stellibs.basel.BaSeL.NHeI" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pypegase.stellibs.basel.BaSeL.NHeII">
<tt class="descname">NHeII</tt><a class="reference internal" href="_modules/pypegase/stellibs/basel.html#BaSeL.NHeII"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypegase.stellibs.basel.BaSeL.NHeII" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pypegase.stellibs.basel.BaSeL.Teff">
<tt class="descname">Teff</tt><a class="reference internal" href="_modules/pypegase/stellibs/basel.html#BaSeL.Teff"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypegase.stellibs.basel.BaSeL.Teff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pypegase.stellibs.basel.BaSeL.Z">
<tt class="descname">Z</tt><a class="reference internal" href="_modules/pypegase/stellibs/basel.html#BaSeL.Z"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypegase.stellibs.basel.BaSeL.Z" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pypegase.stellibs.basel.BaSeL.bbox">
<tt class="descname">bbox</tt><big>(</big><em>dlogT=0.05</em>, <em>dlogg=0.25</em><big>)</big><a class="reference internal" href="_modules/pypegase/stellibs/basel.html#BaSeL.bbox"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypegase.stellibs.basel.BaSeL.bbox" title="Permalink to this definition">¶</a></dt>
<dd><p>Boundary of Basel 2.2 library</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>dlogT: float</strong></p>
<blockquote>
<div><p>log-temperature tolerance before extrapolation limit</p>
</div></blockquote>
<p><strong>dlogg: float</strong></p>
<blockquote>
<div><p>log-g tolerance before extrapolation limit</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">bbox: ndarray</p>
<blockquote class="last">
<div><p>(logT, logg) edges of the bounding polygon</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pypegase.stellibs.basel.BaSeL.logT">
<tt class="descname">logT</tt><a class="reference internal" href="_modules/pypegase/stellibs/basel.html#BaSeL.logT"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypegase.stellibs.basel.BaSeL.logT" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pypegase.stellibs.basel.BaSeL.logZ">
<tt class="descname">logZ</tt><a class="reference internal" href="_modules/pypegase/stellibs/basel.html#BaSeL.logZ"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypegase.stellibs.basel.BaSeL.logZ" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pypegase.stellibs.basel.BaSeL.logg">
<tt class="descname">logg</tt><a class="reference internal" href="_modules/pypegase/stellibs/basel.html#BaSeL.logg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypegase.stellibs.basel.BaSeL.logg" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="pypegase.stellibs.basel.BaSeL_old">
<em class="property">class </em><tt class="descclassname">pypegase.stellibs.basel.</tt><tt class="descname">BaSeL_old</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/pypegase/stellibs/basel.html#BaSeL_old"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypegase.stellibs.basel.BaSeL_old" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pypegase.stellibs.stellib.Stellib" title="pypegase.stellibs.stellib.Stellib"><tt class="xref py py-class docutils literal"><span class="pre">pypegase.stellibs.stellib.Stellib</span></tt></a></p>
<dl class="docutils">
<dt>BaSeL 2.2 + Rauch stellar library derived class</dt>
<dd>This library is used in Pegase.2</dd>
</dl>
<p>The BaSeL stellar spectral energy distribution (SED) libraries are libraries of
theoretical stellar SEDs recalibrated using empirical photometric data.
Therefore, we call them semi-empirical libraries.</p>
<p>The BaSeL 2.2 library was calibrated using photometric data from solar
metallicity stars.</p>
<p class="rubric">References</p>
<ul class="simple">
<li>Lejeune, Cuisiner, and Buser, 1998 A&amp;AS, 130, 65</li>
<li>can be downloaded <a class="reference external" href="http://www.astro.unibas.ch/BaSeL_files/BaSeL2_2.tar.gz">http://www.astro.unibas.ch/BaSeL_files/BaSeL2_2.tar.gz</a></li>
</ul>
<dl class="attribute">
<dt id="pypegase.stellibs.basel.BaSeL_old.NHI">
<tt class="descname">NHI</tt><a class="reference internal" href="_modules/pypegase/stellibs/basel.html#BaSeL_old.NHI"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypegase.stellibs.basel.BaSeL_old.NHI" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pypegase.stellibs.basel.BaSeL_old.NHeI">
<tt class="descname">NHeI</tt><a class="reference internal" href="_modules/pypegase/stellibs/basel.html#BaSeL_old.NHeI"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypegase.stellibs.basel.BaSeL_old.NHeI" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pypegase.stellibs.basel.BaSeL_old.NHeII">
<tt class="descname">NHeII</tt><a class="reference internal" href="_modules/pypegase/stellibs/basel.html#BaSeL_old.NHeII"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypegase.stellibs.basel.BaSeL_old.NHeII" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pypegase.stellibs.basel.BaSeL_old.Teff">
<tt class="descname">Teff</tt><a class="reference internal" href="_modules/pypegase/stellibs/basel.html#BaSeL_old.Teff"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypegase.stellibs.basel.BaSeL_old.Teff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pypegase.stellibs.basel.BaSeL_old.Z">
<tt class="descname">Z</tt><a class="reference internal" href="_modules/pypegase/stellibs/basel.html#BaSeL_old.Z"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypegase.stellibs.basel.BaSeL_old.Z" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pypegase.stellibs.basel.BaSeL_old.bbox">
<tt class="descname">bbox</tt><big>(</big><em>dlogT=0.05</em>, <em>dlogg=0.25</em><big>)</big><a class="reference internal" href="_modules/pypegase/stellibs/basel.html#BaSeL_old.bbox"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypegase.stellibs.basel.BaSeL_old.bbox" title="Permalink to this definition">¶</a></dt>
<dd><p>Boundary of Basel 2.2 library</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>dlogT: float</strong></p>
<blockquote>
<div><p>log-temperature tolerance before extrapolation limit</p>
</div></blockquote>
<p><strong>dlogg: float</strong></p>
<blockquote>
<div><p>log-g tolerance before extrapolation limit</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">bbox: ndarray</p>
<blockquote class="last">
<div><p>(logT, logg) edges of the bounding polygon</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pypegase.stellibs.basel.BaSeL_old.logT">
<tt class="descname">logT</tt><a class="reference internal" href="_modules/pypegase/stellibs/basel.html#BaSeL_old.logT"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypegase.stellibs.basel.BaSeL_old.logT" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pypegase.stellibs.basel.BaSeL_old.logZ">
<tt class="descname">logZ</tt><a class="reference internal" href="_modules/pypegase/stellibs/basel.html#BaSeL_old.logZ"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypegase.stellibs.basel.BaSeL_old.logZ" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pypegase.stellibs.basel.BaSeL_old.logg">
<tt class="descname">logg</tt><a class="reference internal" href="_modules/pypegase/stellibs/basel.html#BaSeL_old.logg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypegase.stellibs.basel.BaSeL_old.logg" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pypegase.stellibs.common">
<span id="pypegase-stellibs-common-module"></span><h2>pypegase.stellibs.common module<a class="headerlink" href="#module-pypegase.stellibs.common" title="Permalink to this headline">¶</a></h2>
<p>Common useful functions</p>
<dl class="function">
<dt id="pypegase.stellibs.common.genIndividualStellarSpectrum">
<tt class="descclassname">pypegase.stellibs.common.</tt><tt class="descname">genIndividualStellarSpectrum</tt><big>(</big><em>stars</em>, <em>Z</em>, <em>osl</em>, <em>inLsun=False</em>, <em>with_units=False</em><big>)</big><a class="reference internal" href="_modules/pypegase/stellibs/common.html#genIndividualStellarSpectrum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypegase.stellibs.common.genIndividualStellarSpectrum" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates individual spectra for the given stars and stellar library</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>stars: Table</strong></p>
<blockquote>
<div><p>contains at least (logT, logg, logL) of the considered stars</p>
</div></blockquote>
<p><strong>Z: float</strong></p>
<blockquote>
<div><p>metallicity</p>
</div></blockquote>
<p><strong>osl: stellib.Stellib</strong></p>
<blockquote>
<div><p>stellar library</p>
</div></blockquote>
<p><strong>inLsun: bool</strong></p>
<blockquote>
<div><p>return results units normalized to Lsun</p>
</div></blockquote>
<p><strong>with_units: bool</strong></p>
<blockquote>
<div><p>if set, return results with units</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">l0: ndarray, ndim=1</p>
<blockquote>
<div><p>wavelength definition of the spectra
wavelength in AA</p>
</div></blockquote>
<p>s0: ndarray, shape=(len(stars), len(l0))</p>
<blockquote>
<div><p>array of spectra, one per input star
Spectrum in ergs/s/AA or ergs/s/AA/Lsun</p>
</div></blockquote>
<p>NHI: ndarray, ndim=1, shape=(len(stars), )</p>
<blockquote class="last">
<div><p>number of photons potentially interacting with HI
NHI property per star</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pypegase.stellibs.common.genStellarSpectrum">
<tt class="descclassname">pypegase.stellibs.common.</tt><tt class="descname">genStellarSpectrum</tt><big>(</big><em>stars</em>, <em>Z</em>, <em>osl</em>, <em>weights=None</em>, <em>inLsun=False</em>, <em>with_units=False</em>, <em>nthreads=1</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/pypegase/stellibs/common.html#genStellarSpectrum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypegase.stellibs.common.genStellarSpectrum" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate the spectrum from stellar content only</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>stars: mytables.Table</strong></p>
<blockquote>
<div><p>contains logT, logg, logL of the considered stars</p>
</div></blockquote>
<p><strong>Z: float</strong></p>
<blockquote>
<div><p>metallicity</p>
</div></blockquote>
<p><strong>osl: stellib.Stellib</strong></p>
<blockquote>
<div><p>stellar library</p>
</div></blockquote>
<p><strong>weigths: numpy.ndarray[float, ndim=1]</strong></p>
<blockquote>
<div><p>weighted contribution of each star</p>
</div></blockquote>
<p><strong>inLsun: bool</strong></p>
<blockquote>
<div><p>return results units normalized to Lsun</p>
</div></blockquote>
<p><strong>with_units: bool</strong></p>
<blockquote>
<div><p>if set, return results with units</p>
</div></blockquote>
<p><strong>nthreads: int</strong></p>
<blockquote>
<div><p>number of threads during interpolation</p>
</div></blockquote>
<p><strong>**kwargs are passed to osl.interpMany</strong></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">r: ndarray[float, ndim=2]</p>
<blockquote>
<div><p>star index in the spectral library with respective contibutions</p>
</div></blockquote>
<p>l0: ndarray[float, ndim=1]</p>
<blockquote>
<div><p>wavelength in AA</p>
</div></blockquote>
<p>s0: ndarray[float, ndim=1]</p>
<blockquote>
<div><p>Spectrum in ergs/s/AA or ergs/s/AA/Lsun</p>
</div></blockquote>
<p>NHI: float</p>
<blockquote class="last">
<div><p>number of photons potentially interacting with HI</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pypegase.stellibs.common.interp_indidivualstars">
<tt class="descclassname">pypegase.stellibs.common.</tt><tt class="descname">interp_indidivualstars</tt><big>(</big><em>stars</em>, <em>Z</em>, <em>osl</em>, <em>weights=None</em>, <em>inLsun=False</em>, <em>nthreads=1</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/pypegase/stellibs/common.html#interp_indidivualstars"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypegase.stellibs.common.interp_indidivualstars" title="Permalink to this definition">¶</a></dt>
<dd><p>Build for each star individually the interpolation weights from the
library to generate individual spectra.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>stars: Table</strong></p>
<blockquote>
<div><p>contains at least (logT, logg, logL) of the considered stars</p>
</div></blockquote>
<p><strong>Z: float</strong></p>
<blockquote>
<div><p>metallicity</p>
</div></blockquote>
<p><strong>osl: stellib.Stellib</strong></p>
<blockquote>
<div><p>stellar library</p>
</div></blockquote>
<p><strong>weigths: ndarray[float, ndim=1]</strong></p>
<blockquote>
<div><p>weighted contribution of each star</p>
</div></blockquote>
<p><strong>inLsun: bool</strong></p>
<blockquote>
<div><p>return results units normalized to Lsun</p>
</div></blockquote>
<p><strong>nthreads: int</strong></p>
<blockquote>
<div><p>number of threads during interpolation</p>
</div></blockquote>
<p><strong>**kwargs are passed to osl.interpMany</strong></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">r: ndarray[float, ndim=2]</p>
<blockquote class="last">
<div><p>star index in the spectral library with respective contibutions</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pypegase.stellibs.common.interp_manystars">
<tt class="descclassname">pypegase.stellibs.common.</tt><tt class="descname">interp_manystars</tt><big>(</big><em>stars</em>, <em>Z</em>, <em>osl</em>, <em>weights=None</em>, <em>inLsun=False</em>, <em>nthreads=1</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/pypegase/stellibs/common.html#interp_manystars"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypegase.stellibs.common.interp_manystars" title="Permalink to this definition">¶</a></dt>
<dd><p>Build for the ensemble of stars the interpolation weights from the library
to generate the integrated spectrum</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>stars: Table</strong></p>
<blockquote>
<div><p>contains at least (logT, logg, logL) of the considered stars</p>
</div></blockquote>
<p><strong>Z: float</strong></p>
<blockquote>
<div><p>metallicity</p>
</div></blockquote>
<p><strong>osl: stellib.Stellib</strong></p>
<blockquote>
<div><p>stellar library</p>
</div></blockquote>
<p><strong>weigths: ndarray[float, ndim=1]</strong></p>
<blockquote>
<div><p>weighted contribution of each star</p>
</div></blockquote>
<p><strong>inLsun: bool</strong></p>
<blockquote>
<div><p>return results units normalized to Lsun</p>
</div></blockquote>
<p><strong>nthreads: int</strong></p>
<blockquote>
<div><p>number of threads during interpolation</p>
</div></blockquote>
<p><strong>**kwargs are passed to osl.interpMany</strong></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">r: ndarray[float, ndim=2]</p>
<blockquote class="last">
<div><p>star index in the spectral library with respective contibutions</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-pypegase.stellibs.elodie">
<span id="pypegase-stellibs-elodie-module"></span><h2>pypegase.stellibs.elodie module<a class="headerlink" href="#module-pypegase.stellibs.elodie" title="Permalink to this headline">¶</a></h2>
<p>Stellar library class</p>
<p>Intent to implement a generic module to manage stellar library from various
sources.</p>
<p>The interpolation is implemented from the pegase.2 fortran converted algorithm.
(this may not be super pythonic though)</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">a cython version is available for speed up and should be used transparently when available
(run make once)</p>
</div>
<dl class="class">
<dt id="pypegase.stellibs.elodie.Elodie">
<em class="property">class </em><tt class="descclassname">pypegase.stellibs.elodie.</tt><tt class="descname">Elodie</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/pypegase/stellibs/elodie.html#Elodie"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypegase.stellibs.elodie.Elodie" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pypegase.stellibs.stellib.Stellib" title="pypegase.stellibs.stellib.Stellib"><tt class="xref py py-class docutils literal"><span class="pre">pypegase.stellibs.stellib.Stellib</span></tt></a></p>
<p>Elodie 3.1 stellar library derived class</p>
<dl class="attribute">
<dt id="pypegase.stellibs.elodie.Elodie.NHI">
<tt class="descname">NHI</tt><a class="reference internal" href="_modules/pypegase/stellibs/elodie.html#Elodie.NHI"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypegase.stellibs.elodie.Elodie.NHI" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pypegase.stellibs.elodie.Elodie.NHeI">
<tt class="descname">NHeI</tt><a class="reference internal" href="_modules/pypegase/stellibs/elodie.html#Elodie.NHeI"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypegase.stellibs.elodie.Elodie.NHeI" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pypegase.stellibs.elodie.Elodie.NHeII">
<tt class="descname">NHeII</tt><a class="reference internal" href="_modules/pypegase/stellibs/elodie.html#Elodie.NHeII"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypegase.stellibs.elodie.Elodie.NHeII" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pypegase.stellibs.elodie.Elodie.Teff">
<tt class="descname">Teff</tt><a class="reference internal" href="_modules/pypegase/stellibs/elodie.html#Elodie.Teff"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypegase.stellibs.elodie.Elodie.Teff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pypegase.stellibs.elodie.Elodie.Z">
<tt class="descname">Z</tt><a class="reference internal" href="_modules/pypegase/stellibs/elodie.html#Elodie.Z"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypegase.stellibs.elodie.Elodie.Z" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pypegase.stellibs.elodie.Elodie.bbox">
<tt class="descname">bbox</tt><big>(</big><em>dlogT=0.05</em>, <em>dlogg=0.25</em><big>)</big><a class="reference internal" href="_modules/pypegase/stellibs/elodie.html#Elodie.bbox"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypegase.stellibs.elodie.Elodie.bbox" title="Permalink to this definition">¶</a></dt>
<dd><p>Boundary of Elodie library</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>dlogT: float</strong></p>
<blockquote>
<div><p>log-temperature tolerance before extrapolation limit</p>
</div></blockquote>
<p><strong>dlogg: float</strong></p>
<blockquote>
<div><p>log-g tolerance before extrapolation limit</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">bbox: ndarray</p>
<blockquote class="last">
<div><p>(logT, logg) edges of the bounding polygon</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pypegase.stellibs.elodie.Elodie.logT">
<tt class="descname">logT</tt><a class="reference internal" href="_modules/pypegase/stellibs/elodie.html#Elodie.logT"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypegase.stellibs.elodie.Elodie.logT" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pypegase.stellibs.elodie.Elodie.logZ">
<tt class="descname">logZ</tt><a class="reference internal" href="_modules/pypegase/stellibs/elodie.html#Elodie.logZ"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypegase.stellibs.elodie.Elodie.logZ" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pypegase.stellibs.elodie.Elodie.logg">
<tt class="descname">logg</tt><a class="reference internal" href="_modules/pypegase/stellibs/elodie.html#Elodie.logg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypegase.stellibs.elodie.Elodie.logg" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pypegase.stellibs.interpolator">
<span id="pypegase-stellibs-interpolator-module"></span><h2>pypegase.stellibs.interpolator module<a class="headerlink" href="#module-pypegase.stellibs.interpolator" title="Permalink to this headline">¶</a></h2>
<p>Stellar library class</p>
<p>Intent to implement a generic module to manage stellar library from various
sources.</p>
<p>The interpolation is implemented from the pegase.2 fortran converted algorithm.
(this may not be super pythonic though)</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">a cython version is available for speed up and should be used transparently when available
(run make once)</p>
</div>
<dl class="function">
<dt id="pypegase.stellibs.interpolator.interpSingle">
<tt class="descclassname">pypegase.stellibs.interpolator.</tt><tt class="descname">interpSingle</tt><big>(</big><em>args</em><big>)</big><a class="headerlink" href="#pypegase.stellibs.interpolator.interpSingle" title="Permalink to this definition">¶</a></dt>
<dd><p>proxy to interp with a list of arguements</p>
</dd></dl>

<dl class="function">
<dt id="pypegase.stellibs.interpolator.interpMany">
<tt class="descclassname">pypegase.stellibs.interpolator.</tt><tt class="descname">interpMany</tt><big>(</big><em>oSL</em>, <em>logT</em>, <em>logg</em>, <em>Z</em>, <em>logL</em>, <em>dT_max=0.1</em>, <em>eps=1e-06</em>, <em>weights=None</em>, <em>pool=None</em>, <em>nthreads=1</em><big>)</big><a class="headerlink" href="#pypegase.stellibs.interpolator.interpMany" title="Permalink to this definition">¶</a></dt>
<dd><p>proxy to interp that handle multiple stars to interpolate and parallel processing</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>oSL: Stellib instance</strong></p>
<blockquote>
<div><p>spectral library to interpolate</p>
</div></blockquote>
<p><strong>logT: ndarray, dtype=float</strong></p>
<blockquote>
<div><p>log-effective temperature to get</p>
</div></blockquote>
<p><strong>logg: ndarray, dtype=float</strong></p>
<blockquote>
<div><p>log-surface gravity to get</p>
</div></blockquote>
<p><strong>Z: float</strong></p>
<blockquote>
<div><p>metallicity target</p>
</div></blockquote>
<p><strong>logL: ndarray</strong></p>
<blockquote>
<div><p>log-luminosity to get</p>
</div></blockquote>
<p><strong>dT_max: float, optional</strong></p>
<blockquote>
<div><p>If, T2 (resp. T1) is too far from T compared to T1 (resp. T2),
i2 (resp. i1) is not used.
(see below for namings)</p>
</div></blockquote>
<p><strong>eps: float</strong></p>
<blockquote>
<div><p>temperature sensitivity under which points are considered to have the
same temperature</p>
</div></blockquote>
<p><strong>weights: ndarray, dtype=float, optional</strong></p>
<blockquote>
<div><p>optional weighting scheme for each star</p>
</div></blockquote>
<p><strong>pool: Pool instance, optional</strong></p>
<blockquote>
<div><p>pool that can be used to do the computation (expecting a map attribute)</p>
</div></blockquote>
<p><strong>nthreads: int, optiona</strong></p>
<blockquote>
<div><p>if set without providing a pool arguement, configure a new Pool object
to do the computations</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(idx, w): tuples</p>
<blockquote class="last">
<div><dl class="docutils">
<dt>idx: ndarray, dtype=int, size=4</dt>
<dd><p class="first last">4 star indexes</p>
</dd>
<dt>w: ndarray, dtype=float, size=4</dt>
<dd><p class="first last">4 associated weights</p>
</dd>
</dl>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pypegase.stellibs.interpolator.interp">
<tt class="descclassname">pypegase.stellibs.interpolator.</tt><tt class="descname">interp</tt><big>(</big><em>T0</em>, <em>g0</em>, <em>Z0</em>, <em>L0</em>, <em>T</em>, <em>g</em>, <em>Z</em>, <em>dT_max=0.1</em>, <em>eps=1e-06</em>, <em>weight=1.0</em><big>)</big><a class="reference internal" href="_modules/pypegase/stellibs/interpolator.html#interp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypegase.stellibs.interpolator.interp" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolation of the T,g grid</p>
<p>Interpolate on the grid and returns star indices and associated weights,
and Z.</p>
<p>3 to 12 stars are returned.
It calls _interp_, but reduce the output to the relevant stars.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>T0: float</strong></p>
<blockquote>
<div><p>log(Teff) to obtain</p>
</div></blockquote>
<p><strong>g0: float</strong></p>
<blockquote>
<div><p>log(g) to obtain</p>
</div></blockquote>
<p><strong>Z0: float</strong></p>
<blockquote>
<div><p>metallicity to obtain</p>
</div></blockquote>
<p><strong>L0: float</strong></p>
<blockquote>
<div><p>bolometric luminosity to get</p>
</div></blockquote>
<p><strong>T: float</strong></p>
<blockquote>
<div><p>log(Teff) of the grid</p>
</div></blockquote>
<p><strong>g: float</strong></p>
<blockquote>
<div><p>log(g) of the grid</p>
</div></blockquote>
<p><strong>dT_max: float, optional</strong></p>
<blockquote>
<div><p>If, T2 (resp. T1) is too far from T compared to T1 (resp. T2), i2
(resp. i1) is not used.  (see below for namings)</p>
</div></blockquote>
<p><strong>eps: float</strong></p>
<blockquote>
<div><p>temperature sensitivity under which points are considered to have
the same temperature</p>
</div></blockquote>
<p><strong>weight: float, optional</strong></p>
<blockquote>
<div><p>weight to apply to the selected star</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">idx: ndarray, dtype=int, size=4</p>
<blockquote>
<div><p>4 star indexes</p>
</div></blockquote>
<p>w: ndarray, dtype=float, size=4</p>
<blockquote>
<div><p>4 associated weights</p>
</div></blockquote>
<p>Returns 3 to 12 star indexes and associated weights</p>
<p>see _interp_</p>
<p class="last">TODO: compute new weights accounting for Z</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-pypegase.stellibs.stellib">
<span id="pypegase-stellibs-stellib-module"></span><h2>pypegase.stellibs.stellib module<a class="headerlink" href="#module-pypegase.stellibs.stellib" title="Permalink to this headline">¶</a></h2>
<p>Stellar library class</p>
<p>Intent to implement a generic module to manage stellar library from various
sources.</p>
<p>The interpolation is implemented from the pegase.2 fortran converted algorithm.
(this may not be super pythonic though)</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">a cython version is available for speed up and should be used transparently when available
(run make once)</p>
</div>
<dl class="class">
<dt id="pypegase.stellibs.stellib.CompositeStellib">
<em class="property">class </em><tt class="descclassname">pypegase.stellibs.stellib.</tt><tt class="descname">CompositeStellib</tt><big>(</big><em>osllist</em>, <em>*args</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/pypegase/stellibs/stellib.html#CompositeStellib"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypegase.stellibs.stellib.CompositeStellib" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pypegase.stellibs.stellib.Stellib" title="pypegase.stellibs.stellib.Stellib"><tt class="xref py py-class docutils literal"><span class="pre">pypegase.stellibs.stellib.Stellib</span></tt></a></p>
<p>Generates an object from the union of multiple individual libraries</p>
<dl class="attribute">
<dt id="pypegase.stellibs.stellib.CompositeStellib.Teff">
<tt class="descname">Teff</tt><a class="reference internal" href="_modules/pypegase/stellibs/stellib.html#CompositeStellib.Teff"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypegase.stellibs.stellib.CompositeStellib.Teff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pypegase.stellibs.stellib.CompositeStellib.Z">
<tt class="descname">Z</tt><a class="reference internal" href="_modules/pypegase/stellibs/stellib.html#CompositeStellib.Z"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypegase.stellibs.stellib.CompositeStellib.Z" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pypegase.stellibs.stellib.CompositeStellib.genIndividualStellarSpectrum">
<tt class="descname">genIndividualStellarSpectrum</tt><big>(</big><em>stars</em>, <em>Z</em>, <em>inLsun=False</em>, <em>with_units=False</em><big>)</big><a class="reference internal" href="_modules/pypegase/stellibs/stellib.html#CompositeStellib.genIndividualStellarSpectrum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypegase.stellibs.stellib.CompositeStellib.genIndividualStellarSpectrum" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates individual spectra for the given stars and stellar library</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>stars: Table</strong></p>
<blockquote>
<div><p>contains at least (logT, logg, logL) of the considered stars</p>
</div></blockquote>
<p><strong>Z: float</strong></p>
<blockquote>
<div><p>metallicity</p>
</div></blockquote>
<p><strong>inLsun: bool</strong></p>
<blockquote>
<div><p>return results units normalized to Lsun</p>
</div></blockquote>
<p><strong>with_units: bool</strong></p>
<blockquote>
<div><p>if set, return results with units</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">l0: ndarray, ndim=1</p>
<blockquote>
<div><p>wavelength definition of the spectra
wavelength in AA</p>
</div></blockquote>
<p>s0: ndarray, shape=(len(stars), len(l0))</p>
<blockquote>
<div><p>array of spectra, one per input star
Spectrum in ergs/s/AA or ergs/s/AA/Lsun</p>
</div></blockquote>
<p>NHI: ndarray, ndim=1, shape=(len(stars), )</p>
<blockquote class="last">
<div><p>number of photons potentially interacting with HI
NHI property per star</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pypegase.stellibs.stellib.CompositeStellib.genQ">
<tt class="descname">genQ</tt><big>(</big><em>qname</em>, <em>r</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/pypegase/stellibs/stellib.html#CompositeStellib.genQ"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypegase.stellibs.stellib.CompositeStellib.genQ" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a composite value from a previously calculated interpolation
Works on 1 desired star or a population of stars</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>qname: str</strong></p>
<blockquote>
<div><p>quantity name from self.grid</p>
</div></blockquote>
<p><strong>r: (osl, r) tuple</strong></p>
<blockquote>
<div><p>osl: is the library index starting from 1. 0 means no coverage.
r: is the result from interp call on the corresponding library.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">q: float</p>
<blockquote class="last">
<div><p>value (from weighted sum)</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pypegase.stellibs.stellib.CompositeStellib.genSpectrum">
<tt class="descname">genSpectrum</tt><big>(</big><em>T0</em>, <em>g0=None</em>, <em>Z0=None</em>, <em>weights=None</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/pypegase/stellibs/stellib.html#CompositeStellib.genSpectrum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypegase.stellibs.stellib.CompositeStellib.genSpectrum" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Generate a composite sprectrum</dt>
<dd>Does the interpolation or uses a previously calculated interpolation
Works on 1 desired star or a population of stars</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>T0: ndarray(float)</strong></p>
<blockquote>
<div><p>log(Teff) to obtain</p>
</div></blockquote>
<p><strong>g0: ndarray(float)</strong></p>
<blockquote>
<div><p>log(g) to obtain</p>
</div></blockquote>
<p><strong>Z0: ndarray(float)</strong></p>
<blockquote>
<div><p>metallicity values</p>
</div></blockquote>
<p><strong>weights: ndarray(float)</strong></p>
<blockquote>
<div><p>individual weights of each star</p>
</div></blockquote>
<p><strong>**kwargs forwarded to interp(Many)</strong></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">s: ndarray</p>
<blockquote>
<div><p>an array containing the composite spectrum reinterpolated onto self.wavelength</p>
</div></blockquote>
<div class="last admonition note">
<p class="first admonition-title">Note</p>
<p class="last">if T0 and g0 are iterable, it calls interpMany</p>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pypegase.stellibs.stellib.CompositeStellib.get_boundaries">
<tt class="descname">get_boundaries</tt><big>(</big><em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/pypegase/stellibs/stellib.html#CompositeStellib.get_boundaries"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypegase.stellibs.stellib.CompositeStellib.get_boundaries" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the closed boundary polygon around the stellar library with
given margins</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>s: Stellib</strong></p>
<blockquote>
<div><p>Stellar library object</p>
</div></blockquote>
<p><strong>dlogT: float</strong></p>
<blockquote>
<div><p>margin in logT</p>
</div></blockquote>
<p><strong>dlogg: float</strong></p>
<blockquote>
<div><p>margin in logg</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">b: ndarray[float, ndim=2]</p>
<blockquote>
<div><p>(closed) boundary points: [logg, Teff] (or [Teff, logg] is swap is True)</p>
</div></blockquote>
<div class="last admonition note">
<p class="first admonition-title">Note</p>
<p class="last">as computing the boundary could take time, it is saved in the object
and only recomputed when parameters are updated</p>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pypegase.stellibs.stellib.CompositeStellib.interp">
<tt class="descname">interp</tt><big>(</big><em>T0</em>, <em>g0</em>, <em>Z0</em>, <em>L0</em>, <em>dT_max=0.1</em>, <em>eps=1e-06</em>, <em>bounds={}</em><big>)</big><a class="reference internal" href="_modules/pypegase/stellibs/stellib.html#CompositeStellib.interp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypegase.stellibs.stellib.CompositeStellib.interp" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolation of the T,g grid</p>
<p>Interpolate on the grid and returns star indices and
associated weights, and Z.</p>
<p>3 to 12 stars are returned.</p>
<p>It calls <tt class="xref py py-func docutils literal"><span class="pre">_interp_()</span></tt>, but reduce the output to the relevant stars.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>T0: double</strong></p>
<blockquote>
<div><p>log(Teff) to obtain</p>
</div></blockquote>
<p><strong>g0: double</strong></p>
<blockquote>
<div><p>log(g) to obtain</p>
</div></blockquote>
<p><strong>T:  double</strong></p>
<blockquote>
<div><p>log(Teff) of the grid</p>
</div></blockquote>
<p><strong>g:  double</strong></p>
<blockquote>
<div><p>log(g) of the grid</p>
</div></blockquote>
<p><strong>dT_max: float</strong></p>
<blockquote>
<div><p>If, T2 (resp. T1) is too far from T compared to T1 (resp. T2),
i2 (resp. i1) is not used.
(see below for namings)</p>
</div></blockquote>
<p><strong>eps: foat</strong></p>
<blockquote>
<div><p>temperature sensitivity under which points are considered to
have the same temperature</p>
</div></blockquote>
<p><strong>bounds: dict</strong></p>
<p><strong>sensitivity to extrapolation (see `:func: Stellib.get_boundaries`)</strong></p>
<blockquote>
<div><p>default: {dlogT:0.1, dlogg:0.3}</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(osl, r): tuple</p>
<blockquote class="last">
<div><p>osl: is the library index starting from 1. 0 means no coverage.
r: is the result from interp call on the corresponding library. a 3 to 12 star indexes and associated weights</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pypegase.stellibs.stellib.CompositeStellib.interpMany">
<tt class="descname">interpMany</tt><big>(</big><em>T0</em>, <em>g0</em>, <em>Z0</em>, <em>L0</em>, <em>dT_max=0.1</em>, <em>eps=1e-06</em>, <em>weights=None</em>, <em>bounds={}</em>, <em>pool=None</em>, <em>nthreads=1</em><big>)</big><a class="reference internal" href="_modules/pypegase/stellibs/stellib.html#CompositeStellib.interpMany"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypegase.stellibs.stellib.CompositeStellib.interpMany" title="Permalink to this definition">¶</a></dt>
<dd><p>run interp on a list of inputs and returns reduced results</p>
<p>Interpolation of the T,g grid at Z0 metallicity</p>
<p>Interpolate on the grid and returns star indices and
associated weights, and Z.
3 to 12 stars are returned.
It calls _interp_, but reduce the output to the relevant stars.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>T0: ndarray(float)</strong></p>
<blockquote>
<div><p>log(Teff) to obtain</p>
</div></blockquote>
<p><strong>g0: ndarray(float)</strong></p>
<blockquote>
<div><p>log(g) to obtain</p>
</div></blockquote>
<p><strong>Z0: ndarray(float)</strong></p>
<blockquote>
<div><p>metallicity values</p>
</div></blockquote>
<p><strong>L0: ndarray(float)</strong></p>
<blockquote>
<div><p>luminosity values</p>
</div></blockquote>
<p><strong>dT_max: float</strong></p>
<blockquote>
<div><p>If, T2 (resp. T1) is too far from T compared to T1 (resp. T2),
i2 (resp. i1) is not used.
(see below for namings)</p>
</div></blockquote>
<p><strong>eps: foat</strong></p>
<blockquote>
<div><p>temperature sensitivity under which points are considered to
have the same temperature</p>
</div></blockquote>
<p><strong>weights: ndarray(float)</strong></p>
<blockquote>
<div><p>luminosity weigths to apply after interpolation</p>
</div></blockquote>
<p><strong>bounds: dict</strong></p>
<blockquote>
<div><p>sensitivity to extrapolation (see <cite>:func: Stellib.get_boundaries</cite>)
default: {dlogT:0.1, dlogg:0.3}</p>
</div></blockquote>
<p><strong>pool: Pool-like object</strong></p>
<blockquote>
<div><p>specify a multiprocessing pool for parallel processing</p>
</div></blockquote>
<p><strong>nthreads: int</strong></p>
<blockquote>
<div><p>number of processes to use by default</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(osl, r): tuple</p>
<blockquote class="last">
<div><p>osl: is the library index starting from 1. 0 means no coverage.
r: is the result from interp call on the corresponding library. A 3
to 12 star indexes and associated weights</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pypegase.stellibs.stellib.CompositeStellib.interp_indidivualstars">
<tt class="descname">interp_indidivualstars</tt><big>(</big><em>stars</em>, <em>Z</em>, <em>weights=None</em>, <em>inLsun=False</em>, <em>nthreads=1</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/pypegase/stellibs/stellib.html#CompositeStellib.interp_indidivualstars"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypegase.stellibs.stellib.CompositeStellib.interp_indidivualstars" title="Permalink to this definition">¶</a></dt>
<dd><p>Build for each star individually the interpolation weights from the
library to generate individual spectra.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>stars: Table</strong></p>
<blockquote>
<div><p>contains at least (logT, logg, logL) of the considered stars</p>
</div></blockquote>
<p><strong>Z: float</strong></p>
<blockquote>
<div><p>metallicity</p>
</div></blockquote>
<p><strong>weigths: ndarray[float, ndim=1]</strong></p>
<blockquote>
<div><p>weighted contribution of each star</p>
</div></blockquote>
<p><strong>inLsun: bool</strong></p>
<blockquote>
<div><p>return results units normalized to Lsun</p>
</div></blockquote>
<p><strong>nthreads: int</strong></p>
<blockquote>
<div><p>number of threads during interpolation</p>
</div></blockquote>
<p><strong>**kwargs are passed to osl.interpMany</strong></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">r: ndarray[float, ndim=2]</p>
<blockquote class="last">
<div><p>star index in the spectral library with respective contibutions</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pypegase.stellibs.stellib.CompositeStellib.interp_manystars">
<tt class="descname">interp_manystars</tt><big>(</big><em>stars</em>, <em>Z</em>, <em>weights=None</em>, <em>inLsun=False</em>, <em>nthreads=1</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/pypegase/stellibs/stellib.html#CompositeStellib.interp_manystars"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypegase.stellibs.stellib.CompositeStellib.interp_manystars" title="Permalink to this definition">¶</a></dt>
<dd><p>Build for the ensemble of stars the interpolation weights from the library
to generate the integrated spectrum</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>stars: Table</strong></p>
<blockquote>
<div><p>contains at least (logT, logg, logL) of the considered stars</p>
</div></blockquote>
<p><strong>Z: float</strong></p>
<blockquote>
<div><p>metallicity</p>
</div></blockquote>
<p><strong>weigths: ndarray[float, ndim=1]</strong></p>
<blockquote>
<div><p>weighted contribution of each star</p>
</div></blockquote>
<p><strong>inLsun: bool</strong></p>
<blockquote>
<div><p>return results units normalized to Lsun</p>
</div></blockquote>
<p><strong>nthreads: int</strong></p>
<blockquote>
<div><p>number of threads during interpolation</p>
</div></blockquote>
<p><strong>**kwargs are passed to osl.interpMany</strong></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">r: ndarray[float, ndim=2]</p>
<blockquote class="last">
<div><p>star index in the spectral library with respective contibutions</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pypegase.stellibs.stellib.CompositeStellib.logT">
<tt class="descname">logT</tt><a class="reference internal" href="_modules/pypegase/stellibs/stellib.html#CompositeStellib.logT"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypegase.stellibs.stellib.CompositeStellib.logT" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pypegase.stellibs.stellib.CompositeStellib.logZ">
<tt class="descname">logZ</tt><a class="reference internal" href="_modules/pypegase/stellibs/stellib.html#CompositeStellib.logZ"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypegase.stellibs.stellib.CompositeStellib.logZ" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pypegase.stellibs.stellib.CompositeStellib.logg">
<tt class="descname">logg</tt><a class="reference internal" href="_modules/pypegase/stellibs/stellib.html#CompositeStellib.logg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypegase.stellibs.stellib.CompositeStellib.logg" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pypegase.stellibs.stellib.CompositeStellib.name">
<tt class="descname">name</tt><a class="reference internal" href="_modules/pypegase/stellibs/stellib.html#CompositeStellib.name"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypegase.stellibs.stellib.CompositeStellib.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pypegase.stellibs.stellib.CompositeStellib.set_default_extrapolation_bounds">
<tt class="descname">set_default_extrapolation_bounds</tt><big>(</big><em>dlogT=None</em>, <em>dlogg=None</em><big>)</big><a class="reference internal" href="_modules/pypegase/stellibs/stellib.html#CompositeStellib.set_default_extrapolation_bounds"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypegase.stellibs.stellib.CompositeStellib.set_default_extrapolation_bounds" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pypegase.stellibs.stellib.CompositeStellib.source">
<tt class="descname">source</tt><a class="reference internal" href="_modules/pypegase/stellibs/stellib.html#CompositeStellib.source"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypegase.stellibs.stellib.CompositeStellib.source" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pypegase.stellibs.stellib.CompositeStellib.wavelength">
<tt class="descname">wavelength</tt><a class="reference internal" href="_modules/pypegase/stellibs/stellib.html#CompositeStellib.wavelength"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypegase.stellibs.stellib.CompositeStellib.wavelength" title="Permalink to this definition">¶</a></dt>
<dd><p>return a common wavelength sampling to all libraries. This can be
used to reinterpolate any spectrum onto a common definition</p>
</dd></dl>

<dl class="method">
<dt id="pypegase.stellibs.stellib.CompositeStellib.which_osl">
<tt class="descname">which_osl</tt><big>(</big><em>xypoints</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/pypegase/stellibs/stellib.html#CompositeStellib.which_osl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypegase.stellibs.stellib.CompositeStellib.which_osl" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the library indice that contains each point in xypoints</p>
<p>The decision is made from a two step search:</p>
<blockquote>
<div><ul class="simple">
<li>first, each point is checked against the strict boundary of each
library (i.e., dlogT = 0, dlogg = 0).</li>
<li>second, if points are not found in strict mode, the boundary is
relaxed and a new search is made.</li>
</ul>
</div></blockquote>
<p>Each point is associated to the first library matching the above conditions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>xypoints: sequence</strong></p>
<blockquote>
<div><p>a sequence of N logg, logT pairs.</p>
</div></blockquote>
<p><strong>dlogT: float</strong></p>
<blockquote>
<div><p>margin in logT</p>
</div></blockquote>
<p><strong>dlogg: float</strong></p>
<blockquote>
<div><p>margin in logg</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">res: ndarray(dtype=int)</p>
<blockquote class="last">
<div><p>a ndarray, 0 meaning no library covers the point, and 1, ... n, for the n-th library</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pypegase.stellibs.stellib.Stellib">
<em class="property">class </em><tt class="descclassname">pypegase.stellibs.stellib.</tt><tt class="descname">Stellib</tt><big>(</big><em>*args</em>, <em>**kargs</em><big>)</big><a class="reference internal" href="_modules/pypegase/stellibs/stellib.html#Stellib"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypegase.stellibs.stellib.Stellib" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">builtins.object</span></tt></p>
<p>Basic stellar library class</p>
<dl class="method">
<dt id="pypegase.stellibs.stellib.Stellib.genIndividualStellarSpectrum">
<tt class="descname">genIndividualStellarSpectrum</tt><big>(</big><em>stars</em>, <em>Z</em>, <em>inLsun=False</em>, <em>with_units=False</em><big>)</big><a class="reference internal" href="_modules/pypegase/stellibs/stellib.html#Stellib.genIndividualStellarSpectrum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypegase.stellibs.stellib.Stellib.genIndividualStellarSpectrum" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates individual spectra for the given stars and stellar library</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>stars: Table</strong></p>
<blockquote>
<div><p>contains at least (logT, logg, logL) of the considered stars</p>
</div></blockquote>
<p><strong>Z: float</strong></p>
<blockquote>
<div><p>metallicity</p>
</div></blockquote>
<p><strong>inLsun: bool</strong></p>
<blockquote>
<div><p>return results units normalized to Lsun</p>
</div></blockquote>
<p><strong>with_units: bool</strong></p>
<blockquote>
<div><p>if set, return results with units</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">l0: ndarray, ndim=1</p>
<blockquote>
<div><p>wavelength definition of the spectra
wavelength in AA</p>
</div></blockquote>
<p>s0: ndarray, shape=(len(stars), len(l0))</p>
<blockquote>
<div><p>array of spectra, one per input star
Spectrum in ergs/s/AA or ergs/s/AA/Lsun</p>
</div></blockquote>
<p>NHI: ndarray, ndim=1, shape=(len(stars), )</p>
<blockquote class="last">
<div><p>number of photons potentially interacting with HI
NHI property per star</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pypegase.stellibs.stellib.Stellib.genQ">
<tt class="descname">genQ</tt><big>(</big><em>qname</em>, <em>r</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/pypegase/stellibs/stellib.html#Stellib.genQ"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypegase.stellibs.stellib.Stellib.genQ" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a composite value from a previously calculated interpolation
Works on 1 desired star or a population of stars</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>qname: str</strong></p>
<blockquote>
<div><p>quantity name from self.grid</p>
</div></blockquote>
<p><strong>r: tuple</strong></p>
<blockquote>
<div><p>the result from a previous interpolation</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">output: float</p>
<blockquote class="last">
<div><p>Q value from the interpolation</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pypegase.stellibs.stellib.Stellib.genSpectrum">
<tt class="descname">genSpectrum</tt><big>(</big><em>T0</em>, <em>g0=None</em>, <em>Z0=None</em>, <em>weights=None</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/pypegase/stellibs/stellib.html#Stellib.genSpectrum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypegase.stellibs.stellib.Stellib.genSpectrum" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a composite sprectrum</p>
<p>Does the interpolation or uses a previously calculated
interpolation
Works on 1 desired star or a population of stars</p>
<p>if T0 and g0 are iterable, it calls interpMany</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>T0: float or sequence</strong></p>
<blockquote>
<div><p>log(Teff) of each star or a 2d-array containing the result from a
previous interpolation</p>
</div></blockquote>
<p><strong>g0: float or sequence</strong></p>
<blockquote>
<div><p>log(g) of each stars</p>
</div></blockquote>
<p><strong>Z0: float or sequence</strong></p>
<blockquote>
<div><p>metallicity</p>
</div></blockquote>
<p><strong>weights: float or sequence</strong></p>
<blockquote>
<div><p>individual weights of each star</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">s: ndarray</p>
<blockquote class="last">
<div><p>an array containing the composite spectrum</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pypegase.stellibs.stellib.Stellib.genStellarSpectrum">
<tt class="descname">genStellarSpectrum</tt><big>(</big><em>stars</em>, <em>Z</em>, <em>weights=None</em>, <em>inLsun=False</em>, <em>with_units=False</em>, <em>nthreads=1</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/pypegase/stellibs/stellib.html#Stellib.genStellarSpectrum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypegase.stellibs.stellib.Stellib.genStellarSpectrum" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate the spectrum from stellar content only</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>stars: mytables.Table</strong></p>
<blockquote>
<div><p>contains logT, logg, logL of the considered stars</p>
</div></blockquote>
<p><strong>Z: float</strong></p>
<blockquote>
<div><p>metallicity</p>
</div></blockquote>
<p><strong>weigths: numpy.ndarray[float, ndim=1]</strong></p>
<blockquote>
<div><p>weighted contribution of each star</p>
</div></blockquote>
<p><strong>inLsun: bool</strong></p>
<blockquote>
<div><p>return results units normalized to Lsun</p>
</div></blockquote>
<p><strong>with_units: bool</strong></p>
<blockquote>
<div><p>if set, return results with units</p>
</div></blockquote>
<p><strong>nthreads: int</strong></p>
<blockquote>
<div><p>number of threads during interpolation</p>
</div></blockquote>
<p><strong>**kwargs are passed to osl.interpMany</strong></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">r: ndarray[float, ndim=2]</p>
<blockquote>
<div><p>star index in the spectral library with respective contibutions</p>
</div></blockquote>
<p>l0: ndarray[float, ndim=1]</p>
<blockquote>
<div><p>wavelength in AA</p>
</div></blockquote>
<p>s0: ndarray[float, ndim=1]</p>
<blockquote>
<div><p>Spectrum in ergs/s/AA or ergs/s/AA/Lsun</p>
</div></blockquote>
<p>NHI: float</p>
<blockquote class="last">
<div><p>number of photons potentially interacting with HI</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pypegase.stellibs.stellib.Stellib.get_boundaries">
<tt class="descname">get_boundaries</tt><big>(</big><em>dlogT=0.1</em>, <em>dlogg=0.3</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/pypegase/stellibs/stellib.html#Stellib.get_boundaries"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypegase.stellibs.stellib.Stellib.get_boundaries" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the closed boundary polygon around the stellar library with
given margins</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>s: Stellib</strong></p>
<blockquote>
<div><p>Stellar library object</p>
</div></blockquote>
<p><strong>dlogT: float</strong></p>
<blockquote>
<div><p>margin in logT</p>
</div></blockquote>
<p><strong>dlogg: float</strong></p>
<blockquote>
<div><p>margin in logg</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">b: ndarray[float, ndim=2]</p>
<blockquote>
<div><p>closed boundary edge points: [logT, logg]</p>
</div></blockquote>
<div class="last admonition note">
<p class="first admonition-title">Note</p>
<p class="last">as computing the boundary could take time, it is saved in the object
and only recomputed when parameters are updated</p>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pypegase.stellibs.stellib.Stellib.get_radius">
<tt class="descname">get_radius</tt><big>(</big><em>logl</em>, <em>logt</em><big>)</big><a class="reference internal" href="_modules/pypegase/stellibs/stellib.html#Stellib.get_radius"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypegase.stellibs.stellib.Stellib.get_radius" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the radius of a star given its luminosity and temperature</p>
<p>Assuming a black body, it comes:</p>
<div class="math">
\[R ^ 2 = L / ( 4 \pi \sigma T ^ 4 ),\]</div>
<p>with:</p>
<blockquote>
<div><ul class="simple">
<li>L, luminosity in W,</li>
<li>pi, 3.141592...</li>
<li>sig, Stephan constant in  W * m**-2 * K**-4</li>
<li>T, temperature in K</li>
</ul>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>logl: ndarray[float, ndim=1]</strong></p>
<blockquote>
<div><p>log luminosities from the isochrones, in Lsun</p>
</div></blockquote>
<p><strong>logt: ndarray[float, ndim=1]</strong></p>
<blockquote>
<div><p>log temperatures from the isochrones, in K</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">radii: ndarray[float, ndim=1]</p>
<blockquote class="last">
<div><p>array of radii in m (SI units)</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pypegase.stellibs.stellib.Stellib.interp">
<tt class="descname">interp</tt><big>(</big><em>T0</em>, <em>g0</em>, <em>Z0</em>, <em>L0</em>, <em>dT_max=0.1</em>, <em>eps=1e-06</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/pypegase/stellibs/stellib.html#Stellib.interp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypegase.stellibs.stellib.Stellib.interp" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolation of the T,g grid</p>
<p>Interpolate on the grid and returns star indices and
associated weights, and Z.
3 to 12 stars are returned.
It calls _interp_, but reduce the output to the relevant stars.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>T0: float</strong></p>
<blockquote>
<div><p>log(Teff) to obtain</p>
</div></blockquote>
<p><strong>g0: float</strong></p>
<blockquote>
<div><p>log(g) to obtain</p>
</div></blockquote>
<p><strong>Z0: float</strong></p>
<blockquote>
<div><p>metallicity to obtain</p>
</div></blockquote>
<p><strong>L0: float</strong></p>
<blockquote>
<div><p>bolometric luminosity to get</p>
</div></blockquote>
<p><strong>T: float</strong></p>
<blockquote>
<div><p>log(Teff) of the grid</p>
</div></blockquote>
<p><strong>g: float</strong></p>
<blockquote>
<div><p>log(g) of the grid</p>
</div></blockquote>
<p><strong>dT_max: float, optional</strong></p>
<blockquote>
<div><p>If, T2 (resp. T1) is too far from T compared to T1 (resp. T2), i2
(resp. i1) is not used.  (see below for namings)</p>
</div></blockquote>
<p><strong>eps: float</strong></p>
<blockquote>
<div><p>temperature sensitivity under which points are considered to have
the same temperature</p>
</div></blockquote>
<p><strong>weight: float, optional</strong></p>
<blockquote>
<div><p>weight to apply to the selected star</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">idx:  ndarray(dtype=float)</p>
<blockquote>
<div><p>3 to 12 star indexes in the library</p>
</div></blockquote>
<p>val: ndarray</p>
<blockquote>
<div><p>associated weights</p>
</div></blockquote>
<table class="last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">todo:</th><td class="field-body">compute new weights accounting for Z</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pypegase.stellibs.stellib.Stellib.interpMany">
<tt class="descname">interpMany</tt><big>(</big><em>T0</em>, <em>g0</em>, <em>Z0</em>, <em>L0</em>, <em>dT_max=0.1</em>, <em>eps=1e-06</em>, <em>weights=None</em>, <em>pool=None</em>, <em>nthreads=1</em><big>)</big><a class="reference internal" href="_modules/pypegase/stellibs/stellib.html#Stellib.interpMany"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypegase.stellibs.stellib.Stellib.interpMany" title="Permalink to this definition">¶</a></dt>
<dd><p>run interp on a list of inputs and returns reduced results</p>
<p>Interpolation of the T,g grid at Z0 metallicity</p>
<p>Interpolate on the grid and returns star indices and
associated weights, and Z.
3 to 12 stars are returned.
It calls _interp_, but reduce the output to the relevant stars.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>T0  ndarray(float)</strong></p>
<blockquote>
<div><p>log(Teff) to obtain</p>
</div></blockquote>
<p><strong>g0  ndarray(float)</strong></p>
<blockquote>
<div><p>log(g) to obtain</p>
</div></blockquote>
<p><strong>Z0 ndarray(float)</strong></p>
<blockquote>
<div><p>metallicity values</p>
</div></blockquote>
<p><strong>L0 ndarray(float)</strong></p>
<blockquote>
<div><p>luminosity values</p>
</div></blockquote>
<p><strong>dT_max: float, optional</strong></p>
<blockquote>
<div><p>If, T2 (resp. T1) is too far from T compared to T1 (resp. T2),
i2 (resp. i1) is not used.
(see below for namings)</p>
</div></blockquote>
<p><strong>eps: float</strong></p>
<blockquote>
<div><p>temperature sensitivity under which points are considered to have
the same temperature</p>
</div></blockquote>
<p><strong>weights: ndarray(float)</strong></p>
<blockquote>
<div><p>luminosity weigths to apply after interpolation</p>
</div></blockquote>
<p><strong>pool: Pool-like object</strong></p>
<blockquote>
<div><p>specify a multiprocessing pool for parallel processing</p>
</div></blockquote>
<p><strong>nthreads: int</strong></p>
<blockquote>
<div><p>number of processes to use by default</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">r: ndarray, ndim=2</p>
<blockquote class="last">
<div><p>Returns 3 to 12 star indexes and associated weights</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pypegase.stellibs.stellib.Stellib.interp_indidivualstars">
<tt class="descname">interp_indidivualstars</tt><big>(</big><em>stars</em>, <em>Z</em>, <em>weights=None</em>, <em>inLsun=False</em>, <em>nthreads=1</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/pypegase/stellibs/stellib.html#Stellib.interp_indidivualstars"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypegase.stellibs.stellib.Stellib.interp_indidivualstars" title="Permalink to this definition">¶</a></dt>
<dd><p>Build for each star individually the interpolation weights from the
library to generate individual spectra.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>stars: Table</strong></p>
<blockquote>
<div><p>contains at least (logT, logg, logL) of the considered stars</p>
</div></blockquote>
<p><strong>Z: float</strong></p>
<blockquote>
<div><p>metallicity</p>
</div></blockquote>
<p><strong>weigths: ndarray[float, ndim=1]</strong></p>
<blockquote>
<div><p>weighted contribution of each star</p>
</div></blockquote>
<p><strong>inLsun: bool</strong></p>
<blockquote>
<div><p>return results units normalized to Lsun</p>
</div></blockquote>
<p><strong>nthreads: int</strong></p>
<blockquote>
<div><p>number of threads during interpolation</p>
</div></blockquote>
<p><strong>**kwargs are passed to osl.interpMany</strong></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">osl: ndarray(float, ndim=1)</p>
<blockquote>
<div><p>stellib index of the stars</p>
</div></blockquote>
<p>r: ndarray[float, ndim=2]</p>
<blockquote class="last">
<div><p>star index in the spectral library with respective contibutions</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pypegase.stellibs.stellib.Stellib.interp_manystars">
<tt class="descname">interp_manystars</tt><big>(</big><em>stars</em>, <em>Z</em>, <em>weights=None</em>, <em>inLsun=False</em>, <em>nthreads=1</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/pypegase/stellibs/stellib.html#Stellib.interp_manystars"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypegase.stellibs.stellib.Stellib.interp_manystars" title="Permalink to this definition">¶</a></dt>
<dd><p>Build for the ensemble of stars the interpolation weights from the library
to generate the integrated spectrum</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>stars: Table</strong></p>
<blockquote>
<div><p>contains at least (logT, logg, logL) of the considered stars</p>
</div></blockquote>
<p><strong>Z: float</strong></p>
<blockquote>
<div><p>metallicity</p>
</div></blockquote>
<p><strong>weigths: ndarray[float, ndim=1]</strong></p>
<blockquote>
<div><p>weighted contribution of each star</p>
</div></blockquote>
<p><strong>inLsun: bool</strong></p>
<blockquote>
<div><p>return results units normalized to Lsun</p>
</div></blockquote>
<p><strong>nthreads: int</strong></p>
<blockquote>
<div><p>number of threads during interpolation</p>
</div></blockquote>
<p><strong>**kwargs are passed to osl.interpMany</strong></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">r: ndarray[float, ndim=2]</p>
<blockquote class="last">
<div><p>star index in the spectral library with respective contibutions</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pypegase.stellibs.stellib.Stellib.nbytes">
<tt class="descname">nbytes</tt><a class="reference internal" href="_modules/pypegase/stellibs/stellib.html#Stellib.nbytes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypegase.stellibs.stellib.Stellib.nbytes" title="Permalink to this definition">¶</a></dt>
<dd><p>return the number of bytes of the object</p>
</dd></dl>

<dl class="method">
<dt id="pypegase.stellibs.stellib.Stellib.plot_boundary">
<tt class="descname">plot_boundary</tt><big>(</big><em>ax=None</em>, <em>dlogT=0.0</em>, <em>dlogg=0.0</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/pypegase/stellibs/stellib.html#Stellib.plot_boundary"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypegase.stellibs.stellib.Stellib.plot_boundary" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>dlogT: float</strong></p>
<blockquote>
<div><p>margin in logT (see get_boundaries)</p>
</div></blockquote>
<p><strong>dlogg: float</strong></p>
<blockquote>
<div><p>margin in logg (see get_boundaries)</p>
</div></blockquote>
<p><strong>.. see also::</strong></p>
<blockquote class="last">
<div><dl class="docutils">
<dt><tt class="xref py py-func docutils literal"><span class="pre">matplotlib.plot()</span></tt></dt>
<dd><p class="first last">For additional kwargs</p>
</dd>
</dl>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pypegase.stellibs.stellib.Stellib.points_inside">
<tt class="descname">points_inside</tt><big>(</big><em>xypoints</em>, <em>dlogT=0.1</em>, <em>dlogg=0.3</em><big>)</big><a class="reference internal" href="_modules/pypegase/stellibs/stellib.html#Stellib.points_inside"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypegase.stellibs.stellib.Stellib.points_inside" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns if a point is inside the polygon defined by the boundary of the library</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>xypoints: sequence</strong></p>
<blockquote>
<div><p>a sequence of N logg, logT pairs.</p>
</div></blockquote>
<p><strong>dlogT: float</strong></p>
<blockquote>
<div><p>margin in logT</p>
</div></blockquote>
<p><strong>dlogg: float</strong></p>
<blockquote>
<div><p>margin in logg</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">r: ndarray(dtype=bool)</p>
<blockquote class="last">
<div><p>a boolean ndarray, True for points inside the polygon.
A point on the boundary may be treated as inside or outside.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pypegase.stellibs">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-pypegase.stellibs" title="Permalink to this headline">¶</a></h2>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">pyPegase</a></h1>





<p>
<iframe src="https://ghbtns.com/github-btn.html?user=mfouesneau&repo=pypegase&type=watch&count=true&size=large"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>



  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">pypegase.stellibs package</a><ul>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-pypegase.stellibs.basel">pypegase.stellibs.basel module</a></li>
<li><a class="reference internal" href="#module-pypegase.stellibs.common">pypegase.stellibs.common module</a></li>
<li><a class="reference internal" href="#module-pypegase.stellibs.elodie">pypegase.stellibs.elodie module</a></li>
<li><a class="reference internal" href="#module-pypegase.stellibs.interpolator">pypegase.stellibs.interpolator module</a></li>
<li><a class="reference internal" href="#module-pypegase.stellibs.stellib">pypegase.stellibs.stellib module</a></li>
<li><a class="reference internal" href="#module-pypegase.stellibs">Module contents</a></li>
</ul>
</li>
</ul>

<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="index.html">pyPegase 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2015, Morgan Fouesneau, Ariane Lancon, and Michel Fioc.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.3.
    </div>
  </body>
</html>